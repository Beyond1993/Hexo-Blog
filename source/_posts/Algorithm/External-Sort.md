---
title: External-Sort
date: 2017-12-23 07:10:45
categories: Algorithm
tags:
---
http://www.cnblogs.com/LUO77/p/5838206.html

以前一直知道外排这一算法，知道怎么去实现, 以为就像内部排序那样是一个算法，逻辑顺序问题，但是这次面试mircovision, 才发现这个还挺复杂。他更像是一道系统设计题，而不是算法题。

单机处理大文件时，在针对内部排序不能解决的情况，我们可以借助磁盘保存中间结果，再进行归并排序。

所以大体上外排分两步.

1. 将大的文件分成N份小的文件，每一份小文件，进行内部排序。

2. 对有序子文件逐趟归并，使其整个文件有序。

对于 N 份小文件, n / k, n / (k ^ 2), n / (k^3), ... n / (k ^ 4).. 1

虽说最开始的读写是 n 个文件，但是因为是并行的，我们只算一次读写。

这样的话，到最后一次 1 = n / (k ^ m) ==> k ^ m = n, 所以得出归并读写的IO 次数, m = log(k,n) 以 k 为底。

想要减小 m, 就要增大K， 减少n, 

突然发现单机上的外排，和hadoop 集群是多像啊，那个模拟hadoop shuffle 的project，刚好就是这个外排序。 其实也很好理解，增大K, 减少N 的现实意义在减少输入文件个数的同时，增加并发的instance。这里的减少IO 操作，映射到系统中就是减少网络传输。



  
