---
title: Huawei
date: 2017-10-16 06:10:39
categories: 未分类
tags:
---


实习期自我总结，从实习培养目标，计划及完成情况进行总结。



不知不觉两个月很快就过去了，感学华为公司给我了这次宝贵的第一份实习经历，如同初恋一般紧张又甜蜜。



本次实习我主要 学习mongoDB 分布式数据库的处理，

我看完了mongoDB 的官方文档。实现了spring ＋　mongoDB 小型系统。



模拟实现了二阶段提交。但是并没有将其运用在实际的工程中。



对分布式数据的事务，有了更深刻的理解，更深刻理解面向对象思想在编程中的运用。







1，协调者出错，参与者也出错；（二阶段提交的唯一弊端）

2，协调者出错，参与者不出错；（new 一个新协调者）

3，协调者不出错，参与者出错；（二阶段解决，参与者返回失败）



mongoDB 性能优化，单文档，二阶段， 三阶段提交， 工作队列，日志系统，版本控制。



二阶段：协调者向参与者询问是否能执行操作，若参与节点同意则协调者发送commit， 完成事务，若参与节点返回失败，则协调者发送回滚信息。

缺点：

1、同步阻塞问题。执行过程中，所有参与节点都是事务阻塞型的。当参与者占有公共资源时，其他第三方节点访问公共资源不得不处于阻塞状态。

2、单点故障。由于协调者的重要性，一旦协调者发生故障。参与者会一直阻塞下去。尤其在第二阶段，协调者发生故障，那么所有的参与者还都处于锁定事务资源的状态中，而无法继续完成事务操作。（如果是协调者挂掉，可以重新选举一个协调者，但是无法解决因为协调者宕机导致的参与者处于阻塞状态的问题）

3、数据不一致。在二阶段提交的阶段二中，当协调者向参与者发送commit请求之后，发生了局部网络异常或者在发送commit请求过程中协调者发生了故障，这回导致只有一部分参与者接受到了commit请求。而在这部分参与者接到commit请求之后就会执行commit操作。但是其他部分未接到commit请求的机器则无法执行事务提交。于是整个分布式系统便出现了数据部一致性的现象。

4、二阶段无法解决的问题：协调者再发出commit消息之后宕机，而唯一接收到这条消息的参与者同时也宕机了。那么即使协调者通过选举协议产生了新的协调者，这条事务的状态也是不确定的，没人知道事务是否被已经提交。


//ppt 里就不写了
三阶段提交：
与两阶段提交不同的是，三阶段提交有两个改动点。

1、引入超时机制。同时在协调者和参与者中都引入超时机制。
2、在第一阶段和第二阶段中插入一个准备阶段。保证了在最后提交阶段之前各参与节点的状态是一致的。

也就是说，除了引入超时机制之外，3PC把2PC的准备阶段再次一分为二，这样三阶段提交就有CanCommit、PreCommit、DoCommit三个阶段。



在DoCommit阶段，不响应的，



三阶段提交就是，而不会一直持有事务资源并处于阻塞状态。　能提交阶段－－> 预提交阶段　－－> 最终提交，　已经预提交了　然而没有得到最终提交的指令，还是会提交，从而解决了阻塞。

下一步提升计划。


